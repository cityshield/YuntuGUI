# 🔧 GitHub Actions 编译失败诊断指南

## 🎯 常见编译失败原因和解决方案

### 1️⃣ **Qt 版本问题**

#### 问题：Qt 6.9 不可用
```yaml
# 错误信息可能类似：
# "Qt 6.9.0 not found" 或 "No matching Qt version"
```

**解决方案**：
- 我们的配置已经包含了 Qt 6.5 备用构建
- 如果主构建失败，会自动尝试 Qt 6.5
- 或者手动触发 Qt 6.5 构建

### 2️⃣ **CMake 配置问题**

#### 问题：CMake 找不到 Qt
```yaml
# 错误信息：
# "Could not find Qt6" 或 "CMAKE_PREFIX_PATH not set"
```

**解决方案**：更新 CMakeLists.txt
```cmake
# 确保设置了正确的 Qt 路径
set(CMAKE_PREFIX_PATH $ENV{Qt6_DIR})
```

### 3️⃣ **编译器问题**

#### 问题：MSVC 编译器找不到
```yaml
# 错误信息：
# "CMAKE_CXX_COMPILER not set" 或 "cl.exe not found"
```

**解决方案**：确保使用了正确的 VS 环境
```yaml
- name: 🔧 Setup MSVC
  uses: microsoft/setup-msbuild@v1.3
  with:
    vs-version: '17.0'
```

### 4️⃣ **头文件包含问题**

#### 问题：QTimer 头文件错误
```cpp
// 错误：
#include <QtWidgets/QTimer>

// 正确：
#include <QtCore/QTimer>
```

**解决方案**：我们已经修复了这个问题

### 5️⃣ **资源文件问题**

#### 问题：QRC 文件找不到
```yaml
# 错误信息：
# "Could not find resources.qrc"
```

**解决方案**：确保 resources.qrc 存在且正确配置

## 🔍 具体诊断步骤

### 步骤 1: 查看详细错误日志

1. 访问：https://github.com/cityshield/YuntuGUI/actions
2. 点击失败的构建任务
3. 展开每个失败的步骤
4. 查看具体的错误信息

### 步骤 2: 检查常见错误模式

#### 模式 A: Qt 安装失败
```
Error: Could not find Qt6
Solution: 使用 Qt 6.5 备用构建
```

#### 模式 B: CMake 配置失败
```
Error: CMAKE_PREFIX_PATH not set
Solution: 检查环境变量设置
```

#### 模式 C: 编译错误
```
Error: C1083 cannot open include file
Solution: 检查头文件包含路径
```

#### 模式 D: 链接错误
```
Error: LNK2019 unresolved external symbol
Solution: 检查 Qt 库链接
```

## 🛠️ 快速修复方案

### 方案 1: 使用 Qt 6.5 构建
```bash
# 手动触发 Qt 6.5 构建
# 访问：https://github.com/cityshield/YuntuGUI/actions
# 点击 "🪟 Build Windows Qt 6.5 (Fallback)"
# 点击 "Run workflow"
```

### 方案 2: 修复 CMakeLists.txt
```cmake
# 添加更兼容的 Qt 查找逻辑
find_package(Qt6 6.5 REQUIRED COMPONENTS Core Widgets Gui)

# 如果 Qt6 找不到，尝试 Qt5
if(NOT Qt6_FOUND)
    find_package(Qt5 REQUIRED COMPONENTS Core Widgets)
endif()
```

### 方案 3: 简化构建配置
```yaml
# 使用更简单的 Qt 安装方式
- name: 📦 Install Qt
  uses: jurplel/install-qt-action@v3
  with:
    version: '6.5.3'  # 使用稳定版本
    host: windows
    target: desktop
    arch: win64_msvc2019_64
```

## 🚀 立即修复步骤

### 1️⃣ 检查具体错误
请告诉我具体的错误信息，比如：
- 哪个步骤失败了？
- 错误消息是什么？
- 构建日志的最后几行是什么？

### 2️⃣ 尝试备用构建
访问：https://github.com/cityshield/YuntuGUI/actions
点击 "🪟 Build Windows Qt 6.5 (Fallback)" 并手动运行

### 3️⃣ 本地测试
如果可能，在本地测试构建：
```bash
cd "/Users/fengdaniu/Documents/cursor try/WinUI/qt-shadcn-design"
mkdir build && cd build
cmake .. -G "Visual Studio 17 2022" -A x64
cmake --build . --config Release
```

## 📞 需要更多信息

为了更准确地诊断问题，请提供：

1. **具体的错误消息** (从 GitHub Actions 日志中复制)
2. **失败的步骤名称** (比如 "Configure CMake" 或 "Build Application")
3. **构建日志的最后几行**
4. **是否尝试了 Qt 6.5 备用构建**

---

**🔧 请分享具体的错误信息，我会提供针对性的解决方案！**
